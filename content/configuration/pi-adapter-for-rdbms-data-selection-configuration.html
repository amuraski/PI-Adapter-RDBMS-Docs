<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>PI Adapter for RDBMS data selection configuration </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="PI Adapter for RDBMS data selection configuration ">
    <meta name="generator" content="docfx 2.56.5.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../content/index.html" width="46">
                <img id="logo" src="../../content/main/shared-content/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge System"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="PIAdapterForRDBMSDataSelectionConfiguration">
<h1 id="pi-adapter-for-rdbms-data-selection-configuration">PI Adapter for RDBMS data selection configuration</h1>

<p>In addition to the data source configuration, you need to provide a data selection configuration to specify the data you want the adapter to collect from the data sources.</p>
<p>Each data selection item references a query whose results contain the value(s) for that item. For more information on queries, see <a class="xref" href="pi-adapter-for-rdbms-queries-configuration.html">PI Adapter for RDBMS queries configuration</a>.</p>
<h2 id="configure-rdbms-data-selection">Configure RDBMS data selection</h2>
<p>Complete the following steps to configure an RDBMS data selection. Use the <code>PUT</code> method in conjunction with the <code>api/v1/configuration/&lt;ComponentId&gt;/DataSelection</code> REST endpoint to initialize the configuration.</p>
<ol>
<li><p>Using a text editor, create an empty text file.</p>
</li>
<li><p>Copy and paste an example configuration for an RDBMS data selection into the file.</p>
<p> For sample JSON, see <a href="#rdbms-data-selection-examples">RDBMS data selection examples</a>.</p>
</li>
<li><p>Update the example JSON parameters for your environment.</p>
<p> For a table of all available parameters, see <a href="#rdbms-data-selection-parameters">RDBMS data selection parameters</a>.</p>
</li>
<li><p>Save the file. For example, as <code>ConfigureDataSelection.json</code>.</p>
</li>
<li><p>Open a command line session. Change directory to the location of <code>ConfigureDataSelection.json</code>.</p>
</li>
<li><p>Enter the following cURL command (which uses the <code>PUT</code> method) to initialize the data selection configuration.</p>
<pre><code class="lang-bash">curl -d &quot;@ConfigureDataSelection.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT &quot;http://localhost:5590/api/v1/configuration/RDBMS1/DataSelection&quot;
</code></pre><p> <strong>Notes:</strong></p>
<ul>
<li>If you installed the adapter to listen on a non-default port, update <code>5590</code> to the port number in use.</li>
<li>If you use a component ID <!-- jokim Apr 12 2021: Did Rainer set a standard for "ID"? was it "Id"? -->other than <code>RDBMS1</code>, update the endpoint with your chosen component ID.</li>
<li>For a list of other REST operations you can perform, like updating or deleting a data selection configuration, see <a href="#rest-urls">REST URLs</a>.
<br>
<br></li>
</ul>
</li>
</ol>
<h2 id="rdbms-data-selection-schema">RDBMS data selection schema</h2>
<p>The full schema definition for the RDBMS data selection configuration is in the <code>RDBMS_DataSelection_schema.json</code> file located in one of the following folders:</p>
<p>Windows: <code>%ProgramFiles%\OSIsoft\Adapters\RDBMS\Schemas</code></p>
<p>Linux: <code>/opt/OSIsoft/Adapters/RDBMS/Schemas</code></p>
<h2 id="rdbms-data-selection-parameters">RDBMS data selection parameters</h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DataFilterId</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The identifier of a data filter defined in the <a class="xref" href="../main/shared-content/configuration/data-filters-configuration.html">Data filters configuration</a>. By default, no filter is applied.</td>
</tr>
<tr>
<td><strong>ValueColumn</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>The database column to read data values from.</td>
</tr>
<tr>
<td><strong>IndexColumn</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Column that contains the timestamp. If no column is specified, the timestamp will be the time that the adapter read the value.</td>
</tr>
<tr>
<td><strong>IdColumn</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Name of the column that contains the IdField. Used to identify which rows of the query results belong to the selection item.</td>
</tr>
<tr>
<td><strong>IdField</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The unique identifier of the source. Should be in the database column specified in <strong>IdColumn</strong>.<!-- jokim Apr 12 2021: a bit too casual of a sentence for me. How about "This identifier is commonly found in the database column..." --> Used to identify which rows of the query results belong to the selection item.</td>
</tr>
<tr>
<td><strong>Name</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The optional friendly <!-- jokim Apr 12 2021: "optional-friendly" although not sure what this actually means... -->name of the data item collected from the data source. If not configured, the default value is the stream ID.</td>
</tr>
<tr>
<td><strong>QueryId</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>The identifier of the query configured.</td>
</tr>
<tr>
<td><strong>ScheduleId</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>The identifier of a schedule defined in the Schedules configuration.</td>
</tr>
<tr>
<td><strong>Selected</strong></td>
<td>Optional</td>
<td><code>boolean</code></td>
<td>If <code>true</code>, data for this item is collected and sent to one or more configured OMF endpoints.<br><br>Allowed value: <code>true</code> or <code>false</code><br>Default value:<code>true</code></td>
</tr>
<tr>
<td><strong>StreamId</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The custom identifier used to create the stream. If not specified, the RDBMS adapter generates a default value based on the <strong>DefaultStreamIdPattern</strong> in the <a class="xref" href="pi-adapter-for-rdbms-data-source-configuration.html">PI Adapter for RDBMS data source configuration</a>.</td>
</tr>
</tbody>
</table>
<h2 id="rdbms-data-selection-examples">RDBMS data selection examples</h2>
<p>There are two main ways to configure a selection item. The first and simplest method is used when the columns of the result set are all that is needed to uniquely identify a stream. The second and most common method is used when each row of the result set contains information necessary to uniquely identify a stream.<br>The following are examples of valid RDBMS data selection configurations:</p>
<h3 id="column-as-an-identifier">Column as an identifier</h3>
<p>This configuration is used when you <!-- jokim Apr 12 2021: use active voice "Use this configuration when..." --> have a table whose columns identify each stream in the result set. In the simplest of cases, there is one value column and one timestamp column; however, there could be multiple values and multiple timestamps. A separate data selection item needs to be defined for each timestamp value pair.</p>
<p>Example data: </p>
<table>
<thead>
<tr>
<th>Temperature</th>
<th>Pressure</th>
<th>Volume</th>
<th>SampleTime</th>
</tr>
</thead>
<tbody>
<tr>
<td>25</td>
<td>100</td>
<td>50.6</td>
<td>11/11/2020 3:56:00 AM</td>
</tr>
<tr>
<td>26.3</td>
<td>100.2</td>
<td>50.7</td>
<td>11/11/2020 3:26:00 AM</td>
</tr>
</tbody>
</table>
<p>Temperature:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank1.Temperature&quot;,
    &quot;ValueColumn&quot;: &quot;Temperature&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tank1&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><p>Pressure:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank1.Pressure&quot;,
    &quot;ValueColumn&quot;: &quot;Pressure&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tank1&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><p>Volume:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank1.Volume&quot;,
    &quot;ValueColumn&quot;: &quot;Volume&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tank1&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><h3 id="identifier-in-row">Identifier in Row</h3>
<p>This configuration is used <!-- jokim Apr 12 2021: use active voice "Use this configuration when..." --> when each row of the result set contains information needed to identify each stream. In the simplest case, there could be one column for the identifier, one column for the timestamp, and one column for the value. However, result sets could contain multiple timestamp columns and multiple value columns. This configuration requires that the user specify the IdColumn and IdField properties.</p>
<p>Example Data:</p>
<table>
<thead>
<tr>
<th>Asset</th>
<th>Temperature</th>
<th>Pressure</th>
<th>Volume</th>
<th>SampleTime</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tank1</td>
<td>25</td>
<td>100</td>
<td>50.6</td>
<td>11/11/2020 3:56:00 AM</td>
</tr>
<tr>
<td>Tank2</td>
<td>26.3</td>
<td>100.2</td>
<td>50.7</td>
<td>11/11/2020 3:56:00 AM</td>
</tr>
<tr>
<td>Tank3</td>
<td>26.4</td>
<td>100.1</td>
<td>50.5</td>
<td>11/11/2020 3:56:00 AM</td>
</tr>
<tr>
<td>Tank2</td>
<td>26.5</td>
<td>100</td>
<td>50.4</td>
<td>11/11/2020 3:46:00 AM</td>
</tr>
<tr>
<td>Tank3</td>
<td>26.6</td>
<td>99.9</td>
<td>50.3</td>
<td>11/11/2020 3:46:00 AM</td>
</tr>
<tr>
<td>Tank1</td>
<td>26.7</td>
<td>99.8</td>
<td>50.2</td>
<td>11/11/2020 3:46:00 AM</td>
</tr>
</tbody>
</table>
<p>Tank1.Temperature:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank1.Temperature&quot;,
    &quot;ValueColumn&quot;: &quot;Temperature&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;IdColumn&quot;: &quot;Asset&quot;,
    &quot;IdField&quot;: &quot;Tank1&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tanks&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><p>Tank2.Temperature:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank2.Temperature&quot;,
    &quot;ValueColumn&quot;: &quot;Temperature&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;IdColumn&quot;: &quot;Asset&quot;,
    &quot;IdField&quot;: &quot;Tank2&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tanks&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><h2 id="rest-urls">REST URLs</h2>
<table>
<thead>
<tr>
<th>Relative URL</th>
<th>HTTP verb</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection</td>
<td><code>GET</code></td>
<td>Retrieves the RDBMS data selection configuration</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection</td>
<td><code>PUT</code></td>
<td>Configures or updates the RDBMS data selection configuration</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection</td>
<td><code>DELETE</code></td>
<td>Deletes the RDBMS data selection configuration</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection</td>
<td><code>PATCH</code></td>
<td>Allows partial updating of configured data selection items. <br><strong>Note:</strong> The request must be an array containing one or more data selection items. Each data selection item in the array must include its <strong>StreamId</strong>.</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection/&lt;StreamId></td>
<td><code>PUT</code></td>
<td>Updates or creates a new data selection with the specified <strong>StreamId</strong></td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection/&lt;StreamId></td>
<td><code>DELETE</code></td>
<td>Deletes a specific data selection item of the RDBMS data selection configuration</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Replace &lt;ComponentId> with the Id of your RDBMS component, for example RDBMS1.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/PI-Adapter-RDBMS-Docs/blob/main/content/configuration/pi-adapter-for-rdbms-data-selection-configuration.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span><a href="https://www.osisoft.com/copyright/">© 2019 - 2021 OSIsoft, LLC. All rights reserved.</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
